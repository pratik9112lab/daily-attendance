<script>
  const api = "http://localhost:3000";

  function getDate() {
    const now = new Date();
    return now.toLocaleDateString();
  }

  function markEntry() {
    const name = document.getElementById('name').value.trim();
    if (!name) return alert('Enter your name!');
    
    fetch(`${api}/entry`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        name,
        date: getDate(),
        entryTime: new Date().toLocaleTimeString()
      })
    }).then(() => fetchRecords());
  }

  function markExit() {
    const name = document.getElementById('name').value.trim();
    if (!name) return alert('Enter your name!');
    
    fetch(`${api}/exit`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        name,
        date: getDate(),
        exitTime: new Date().toLocaleTimeString()
      })
    }).then(() => fetchRecords());
  }

  function fetchRecords() {
    fetch(`${api}/attendance`)
      .then(res => res.json())
      .then(data => {
        const tbody = document.querySelector('#attendanceTable tbody');
        tbody.innerHTML = '';
        data.forEach(row => {
          tbody.innerHTML += `<tr>
            <td>${row.name}</td>
            <td>${row.date}</td>
            <td>${row.entry || '-'}</td>
            <td>${row.exit || '-'}</td>
          </tr>`;
        });
      });
  }

  // Auto-load on page open
  window.onload = fetchRecords;
</script>
